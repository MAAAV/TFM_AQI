# -*- coding: utf-8 -*-

__all__ = ["dades_obertes", "estacions", "icgc", "idaea", "idescat"]

import numpy as np
import pandas as pd

ESTACIONS = {
    "nom_eoi": [
        "Badalona", "Barcelona (Poblenou)", "Barcelona (Sants)", "Barcelona (Eixample)", 
        "Barcelona (Gràcia - Sant Gervasi)", "Barcelona (Ciutadella)", "Barcelona (Parc Vall Hebron)", 
        "Barcelona (Palau Reial)", "Gavà", "L'Hospitalet de Llobregat", "Montcada i Reixac", 
        "El Prat de Llobregat (Jardins de la Pau)", "El Prat de Llobregat (Sagnier)", "Sant Adrià del Besòs", 
        "Sant Andreu de la Barca", "Sant Cugat del Vallès", "Santa Coloma de Gramanet", "Barberà del Vallès", 
        "Sant Vicenç dels Horts (Ribot)", "Sant Vicenç dels Horts", "Viladecans - Atrium"],
    "codi_eoi": [
        '08015021', '08019004', '08019042', '08019043', '08019044', '08019050', '08019054', 
        '08019057', '08089005', '08101001', '08125002', '08169008', '08169009', '08194008', 
        '08196001', '08205002', '08245012', '08252006', '08263001', '08263007', '08301004'],
    "lon": [2.2378986, 2.204501, 2.133099, 2.1537998, 2.1533988, 2.1873982, 2.1480017, 
            2.1151996, 1.9914981, 2.1149993, 2.1882975, 2.0977015, 2.0821, 2.2221997, 
            1.9748996, 2.0889983, 2.209497, 2.1253984, 2.0097985, 1.9997202, 2.0136087],
    "lat": [41.443985, 41.40388, 41.37878, 41.385315, 41.398724, 41.386406, 41.42611, 
            41.38749, 41.303097, 41.370476, 41.48197, 41.321487, 41.321774, 41.425594, 
            41.4508, 41.476814, 41.447422, 41.512684, 41.39219, 41.400845, 41.31335], 
    "etiqueta": [ 'Badalona', 'BCN_Poblenou', 'BCN_Sants', 'BCN_Eixample', 'BCN_Gracia', 'BCN_Ciutadella', 'BCN_Vall_Hebron', 
                  'BCN_Palau_Reial', 'Gava', 'Hospitalet', 'Montcada_i_Reixac', 'ElPrat_Jardins_Pau', 'ElPrat_Sagnier', 'SAdria_Besos', 
                  'SAndreu_Barca', 'SCugat_Valles', 'StaColoma_Gramanet', 'Barbera_Valles', 'SVHorts_Ribot', 'SVHorts', 'Viladecans']
    }

EOI_DF = pd.DataFrame(ESTACIONS)


# codi_eoi: { "LCZvsNO2_500M": [NO2,LCZ_1,LCZ_2,LCZ_3,LCZ_4,LCZ_5,LCZ_6,LCZ_7,LCZ_8,LCZ_9,LCZ_10,LCZ_A,LCZ_B,LCZ_C,LCZ_D,LCZ_E,LCZ_F,LCZ_G,T_LCZ], 
#             "POBLACION_500M": [TOTAL,HOMES,DONES,P_0_14,P_15_64,P_65_I_MES,P_ESPANYOL,P_ESTRANGE,P_NASC_CAT,P_NASC_RES,P_NASC_EST] }
EOI_DATA = {
    '08015021': { 
        "LCZvsNO2_500M": [33,0,278442.682,214240.505,0,7002.86,2.0,0,69726.274,0.0,0,0.0,48304.1669,0.0,0.0,158.911,0.0,0.0,617877.3989], 
        "POBLACION_500M": [19106.0,9267.0,9839.0,2770.0,12694.0,3346.0,12920.0,1576.0,13336.0,2812.0,2113.0]},
    '08019004': { 
        "LCZvsNO2_500M": [37,0,379257.4914,61800.52,0,16716.5,6.0,0,70664.86674,0.0,0,0.0,67516.108,0.0,0.0,435.597715,3072.14,0.0,599469.2238], 
        "POBLACION_500M": [28094.0,13681.0,14413.0,3990.0,19065.0,4345.0,22195.0,4489.0,18486.0,3701.0,5467.0]},
    '08019042': { 
        "LCZvsNO2_500M": [31,0,295977.6811,68365.27626,0,0.0,0.0,0,15903.45779,0.0,0,0.0,39170.90248,0.0,0.0,0.0,0.0,0.0,419417.3177], 
        "POBLACION_500M": [39605.0,18560.0,21027.0,4248.0,25704.0,9278.0,32287.0,5229.0,25297.0,6648.0,7354.0]},
    '08019043': { 
        "LCZvsNO2_500M": [50,0,433988.0194,520.608,0,2149.944,0.0,0,46428.8,0.0,0,0.0,12641.62826,0.0,0.0,855.62,0.0,0.0,496584.6197], 
        "POBLACION_500M": [37590.0,17476.0,20114.0,3776.0,25335.0,8176.0,30329.0,6789.0,22722.0,5489.0,9224.0]},
    '08019044': { 
        "LCZvsNO2_500M": [44,0,442401.9501,45416.734,0,0.0,0.0,0,21029.49,0.0,0,0.0,31025.46,0.0,0.0,795.78299,0.0,0.0,540669.4171], 
        "POBLACION_500M": [26018.0,11833.0,14163.0,3188.0,17705.0,4707.0,19932.0,4824.0,16491.0,3154.0,6043.0]},
    '08019050': { 
        "LCZvsNO2_500M": [32,0,167495.894,8930.168899,0,0.0,334.54,0,179017.273,0.0,0,0.0,293779.5748,10873.1,0.0,1365.395929,0.0,0.0,661795.9466], 
        "POBLACION_500M": [7190.0,3460.0,3730.0,590.0,5061.0,1178.0,4913.0,1998.0,3528.0,1107.0,2333.0]},
    '08019054': { 
        "LCZvsNO2_500M": [29,0,151658.5413,93845.30353,0,48671.26,34105.44,0,222573.6532,0.0,0,0.0,118144.3149,0.0,0.0,5725.805621,0.0,0.0,674724.3185], 
        "POBLACION_500M": [16507.0,7954.0,8505.0,2005.0,10755.0,3516.0,13571.0,1953.0,8869.0,4616.0,2832.0]},
    '08019057': { 
        "LCZvsNO2_500M": [28,0,13.0,0.0,0,89143.30096,56067.98453,0,336927.1054,0.0,0,0.0,215985.4996,0.0,0.0,5118.621515,0.0,0.0,703255.512], 
        "POBLACION_500M": [2845.0,1369.0,1476.0,352.0,1841.0,528.0,1840.0,621.0,1578.0,369.0,699.0]},
    '08089005': { 
        "LCZvsNO2_500M": [15,0,75572.7271,1735.280829,0,22791.12,3820.795,0,68230.32611,2.87525,0,234707.1335,196553.3877,98112.49791,11670.322,6139.396753,5463.61726,265.125929,725064.6053], 
        "POBLACION_500M": [4302.0,2138.0,2147.0,612.0,3009.0,241.0,2161.0,139.0,3217.0,485.0,251.0]},
    '08101001': { 
        "LCZvsNO2_500M": [33,0,409162.6443,99192.50982,0,1190.02,0.0,0,99502.416,0.0,0,0.0,35832.88324,18.94399,0.0,37.86917,230.644,0.0,645167.9305], 
        "POBLACION_500M": [52579.0,25616.0,26940.0,7585.0,35542.0,9280.0,36791.0,15545.0,19944.0,10495.0,21981.0]},
    '08125002': { 
        "LCZvsNO2_500M": [35,0,139042.2891,142262.5054,0,0.0,16211.52189,0,48648.227,3648.6822,0,40269.78746,36249.8466,93280.3618,0.0,36435.66925,72951.7795,22360.8,651361.4702], 
        "POBLACION_500M": [8759.0,4202.0,4510.0,1188.0,5799.0,1523.0,5663.0,944.0,5408.0,1736.0,1387.0]},
    '08169008': { 
        "LCZvsNO2_500M": [33,0,251897.516,104756.9656,0,0.0,2967.589,0,94872.74,1696.5447,0,0.0,74744.573,37506.342,32746.328,465.081429,63118.90843,0.0,664772.5881], 
        "POBLACION_500M": [21556.0,10575.0,10964.0,3028.0,14066.0,4117.0,15310.0,1695.0,12689.0,5372.0,2440.0]},
    '08169009': { 
        "LCZvsNO2_500M": [32,0,84308.417,26897.43,0,956.642,0.0,0,478955.3847,0.0,0,0.0,136823.0241,0.0,0.0,3038.8338,792.7659,0.0,731772.4975], 
        "POBLACION_500M": [5528.0,2732.0,2796.0,867.0,3728.0,549.0,3449.0,197.0,3857.0,915.0,368.0]},
    '08194008': { 
        "LCZvsNO2_500M": [37,0,139614.7481,58082.50993,0,0.0,17586.5,0,60690.838,22065.0,0,0.0,238615.7406,2518.57,0.0,105.194249,6141.888,37134.63,582555.6189], 
        "POBLACION_500M": [9548.0,4658.0,4873.0,1316.0,6396.0,1481.0,6811.0,818.0,6467.0,1545.0,1086.0]},
    '08196001': { 
        "LCZvsNO2_500M": [38,0,183432.5837,27223.95122,0,0.0,227.732,0,185921.945,0.0,0,0.0,132195.8166,62383.72,0.0,1551.705,677.312,33130.44062,626745.2061], 
        "POBLACION_500M": [9552.0,4800.0,4752.0,1782.0,6455.0,1126.0,6913.0,1340.0,5722.0,1781.0,1785.0]},
    '08205002': { 
        "LCZvsNO2_500M": [25,0,152593.6757,86706.70063,0,99117.18749,35674.99762,0,149924.6302,0.0,0,0.0,152673.3165,0.0,0.0,3227.236843,13.6275,0.0,679931.3724], 
        "POBLACION_500M": [13187.0,6249.0,6938.0,1933.0,8749.0,1891.0,9144.0,1675.0,8360.0,2066.0,2293.0]},
    '08245012': { 
        "LCZvsNO2_500M": [33,0,416177.8914,68168.42893,0,0.0,0.0,0,41617.72683,0.0,0,0.0,85045.298,3342.108,0.0,1297.4199,0.0,22270.9,637919.773], 
        "POBLACION_500M": [33771.0,16636.0,17135.0,4766.0,21497.0,7274.0,26391.0,5926.0,16321.0,9561.0,7688.0]},
    '08252006': { 
        "LCZvsNO2_500M": [34,0,120351.4992,345920.3427,0,0.0,467.68217,0,118881.4871,0.0,0,0.0,70083.01928,0.0,0.0,911.12522,3957.14,0.0,660572.2957], 
        "POBLACION_500M": [12376.0,6009.0,6350.0,1676.0,8381.0,1878.0,8525.0,908.0,7790.0,2639.0,1186.0]},
    '08263001': { 
        "LCZvsNO2_500M": [32,0,128839.3854,234603.9914,0,3475.75,14725.42929,0,81184.4439,0.0,0,4782.75,30171.26,63935.11,66368.695,47.0,10795.5019,0.0,638929.3168], 
        "POBLACION_500M": [9635.0,4747.0,4852.0,1190.0,6516.0,1229.0,6433.0,448.0,6808.0,1439.0,652.0]},
    '08263007': { 
        "LCZvsNO2_500M": [28,0,29940.94379,207422.3694,0,0.0,28879.66166,0,96649.75826,613.395,0,2006.72,6429.096263,174422.8714,6416.98,66.411027,6817.3,431.0227,560096.5295], 
        "POBLACION_500M": [5452.0,2754.0,2681.0,773.0,3642.0,732.0,3413.0,381.0,3446.0,1032.0,542.0]},
    '08301004': { 
        "LCZvsNO2_500M": [25,0,202100.0078,116802.6309,0,23803.4,2627.564,0,229160.5089,0.0,0,0.0,93119.0132,0.0,0.0,1731.854945,0.0,0.0,669344.9798], 
        "POBLACION_500M": [12440.0,6152.0,6288.0,1763.0,8236.0,2028.0,7977.0,817.0,7757.0,2499.0,1168.0]}
    }


from .dades_obertes import HORES, CONTAMINANTS
from .dades_obertes import get_all_EOI_data, get_contaminant_data, get_data, get_CM
# HORES = [f"h0{i}" for i in range(1,10)] + [f"h{i}" for i in range(10,25)]
# CONTAMINANTS = {"nom":  ['NO2', 'PM2.5', 'SO2', 'PS', 'CO', 'NO', 'PM10', 'PM1', 'NOX', 'O3', 'C6H6', 'HCT', 'HCNM', 'Cl2', 'HCl', 'H2S', 'Hg'], "codi": [ 8, 9, 1, 3, 6, 7, 10, 11, 12, 14, 30, 42, 44, 53, 58, 65, 331]}
# get_all_EOI_data(ymd) ... obtenim les dades en json de tots els contaminants i de totes les estacions del projecte per una data determinada
# get_contaminant_data(ymd, contaminante = 'NO2') ... a partir de get_all_EOI_data, filtrem per contaminant
# get_data(ymd, nom_eoi, contaminante = 'NO2') ... a partir de get_contaminant_data, filtrem per l'estacio
# get_CM(df)

from .estacions import get_nom_eoi, get_codi_eoi
# get_nom_eoi(codi)
# get_codi_eoi(nom)

from .icgc import VUCI, LCZ_NAME, LCZ_DEFINITION
from .icgc import get_VUCI, get_scenario, get_df_histograma_hores, get_hazard_data, get_LCZ_image, get_LCZ_station_image
# VUCI ... Vulnerability Urban Climate Index (taula Joan Gilabert). Diccionari del tipus lcz:vuci
# get_VUCI(lcz)
# get_scenario(vuci, cvp) ... VUCI_CVP scenarios
# get_df_histograma_hores(contaminante, df)
# get_hazard_data(contaminante, df) ... mitjana dels valors horaris existents

from .idaea import get_NO2_2019, get_LCZmax
# get_NO2_2019(eoi_code)
# get_LCZmax(eoi_code) ... retorna el LCZ amb un percentatge d'area mes gran

from .idescat import get_CVP
# get_CVP(eoi_code, iP = 1) ... calcul de l'index de envelliment segons diferents formulacions (iP)
